\chapter{Improving bounds on the RLS and (1+1) EA}
\label{ch:Content1}

\section{Improving bounds on the RLS and the (1+1) EA}
\begin{theorem}\label{theo:OneMaxResult}
    If $w_1 \ge \frac W 2$  then the RLS and the (1+1) EA reach the optimal value in expected time $\Theta(n\log{}n)$
\end{theorem}
\begin{proof}
    The optimal solution is putting $w_1$ in one bin and all other elements in the other bin.
    So the problem is almost identical to OneMax/ZeroMax.
    A single bit flip of the first bit can only happen, if the emptier bin has a weight of at most $\frac {W-w_1}{2}$.
    After this flip the weight of the emptier bin is at least $\frac {W-w_1}{2}$ and therefore another single bit flip of $w_1$ can only happen before a different bit is flipped.
    % After a different bit has been flipped, the RLS wont flip the first bit again, because it will never result in an improvement.
    The run of the RSHs can be divided into two phases:
    \begin{itemize}
        \item[Phase 1:] The RSH reaches a search point with $b_E \ge \frac {W-w_1}{2}$.
        \item[Phase 2:] The RSH reaches an optimal solution $\Rightarrow w_1$ is in one bin and all other elements are in the other bin.
    \end{itemize}

    The expected length of the first phase is at most $en$ for the (1+1) EA and $n$ for the RLS because the probability of flipping the first bit is at least ${\frac{1}{n}} \cdot {(1 - \frac{1}{n})}^{n-1} \ge \frac{1}{en}$ and therefore the expected time for such a step is at most $\frac{1}{en}^{-1} = en$ for the (1+1) EA and $\frac{1}{n}^{-1}=n$ for the RLS.\newline
    In the second phase the RLS can no longer flip $w_1$ as it does not result in an improvement ever again.
    Therefore the RLS behaves exactly as on OneMax/ZeroMax depending on the value of the first bit and reaches an optimal solution in $\Theta(n\log{}n)$ resulting in a total runtime of $\Theta(n\log{}n)$ (Theorem 3 in~\cite{witt2014fitness}).
    The (1+1) EA has to minimise a linear function of $n-1$ bits which also takes $\Theta(n\log{}n)$ time as well (Corollary 4.2 in~\cite{witt2013tight}).
    \textbf{\textit{TODO: why can't the first bit be flipped any more? Or why does it not matter?}}.

    So the total expected time is $\mathcal{O}(n) + \Theta(n\log{}n) = \Theta(n\log{}n)$
\end{proof}

\begin{lemma}\label{approximationLemmaHelp1}
    If \(b_F \le \frac{2}{3} \cdot W\) the approximation ratio is at most $\frac{4}{3}$
\end{lemma}
\begin{proof}
    \(\frac{b_F}{opt} \le \frac{(2/3) \cdot W}{opt} \le \frac{(2/3) \cdot W}{(1/2) \cdot W} = \frac{4}{3}\), since \(opt \ge \frac{W}{2}\)
\end{proof}

\begin{corollary}\label{approximationCorollaryHelp2}
    If \(w_1 \ge \frac{W}{3}\) and \(w_1\) is in the emptier bin, then the approximation ratio is at most $\frac{4}{3}$
\end{corollary}
\begin{proof}
    $w_1$ is in the emptier bin, so \( b_F \le W - w_1 \le W - \frac{W}{3} = \frac{2W}{3} \) and with Lemma~\ref{approximationLemmaHelp1} the assumption follows.
\end{proof}

\begin{lemma}\label{movingObjectsLemma}
    Any object of weight $v$ can be moved from $b_F$ to $b_E$ if and only if \(b_F - b_E \ge v\)
\end{lemma}
\begin{proof}
    $"\Leftarrow":$\newline
    \(b_F - b_E \ge v \Leftrightarrow b_F \ge b_E + v\), so after moving an object with weight $v$ from $b_F$ to $b_E$, the new weight of $b_E$ is at most the weight of $b_F$ before moving the object, thus the RSH accepts the step.\newline
    $"\Rightarrow":$\newline
    \(b_F - b_E < v \Leftrightarrow b_F < b_E + v\), so moving an object of weight $v$ results in ${b_F}' = b_E+v > b_F$ which results in the step being rejected.
\end{proof}

\begin{corollary}\label{cor:RLSStuck}
    The RLS is stuck in a local optimum if \(b_F-b_E < w_n\) holds and \(b_F > opt\).
\end{corollary}
\begin{proof}
    A single bit flip of weight $v$ can only happen if \(b_F - b_E \ge v\). If \(b_F-b_E < w_n\) there is no weight which satisfies the condition and therefore no single bit flip is possible.
    Since the RLS can only move one bit at a time and only if it results in an improvement, the RLS is stuck.
\end{proof}

\begin{corollary}\label{movingObjectsCorollary}
    Every object \(\le \frac{W}{3}\) can be moved from $b_F$ to $b_E$ if \(b_F \ge \frac{2W}{3}\)
\end{corollary}
\begin{proof}
    \(b_F \ge \frac{2W}{3} \Rightarrow b_E \le W - \frac{2W}{3} \le \frac{W}{3} \Rightarrow b_F - b_E \ge \frac{2W}{3} - \frac{W}{3} = \frac{W}{3}\) and with Lemma~\ref{movingObjectsLemma} the assumption follows.
\end{proof}

\begin{lemma}\label{movingObjectsLemma2}
    In expected time $\mathcal{O}(n\log{}n)$ the weight of the fuller bin can be decreased to \(\le \frac{2W}{3}\) by the RLS and the (1+1) EA if every object besides the biggest in the fuller bin is at most $\frac{W}{3}$ and \(w_1 \le \frac{W}{2}\).
\end{lemma}
\begin{proof}
    In expected time $\mathcal{O}(n\log{}n)$ the RSH can move every object $\le \frac{W}{3}$ to the emptier bin as long as $b_F \ge \frac{2W}{3}$ due to Corollary~\ref{movingObjectsCorollary} and Theorem~\ref{theo:OneMaxResult}.
    So in expected time $\mathcal{O}(n\log{}n)$ the solution can be shifted to $w_1$ being in one bin and all other objects in the other bin.
    The RSH will only stop moving the elements if the condition $b_F \ge \frac{2W}{3}$ is no longer satisfied (Corollary~\ref{movingObjectsCorollary}).
    If \(w_1 \ge \frac{W}{3}\) and every object was moved to the bin without $w_1$, then \(b_F = \max\{W-w_1, w_1\} = W-w_1 \le \frac{2W}{3}\), because \(w_1 \le \frac{W}{2}\).
    So either the RSH moves all objects to the emptier bin or stops moving objects because $b_F < \frac{2W}{3}$ both resulting in $b_F \le \frac{2W}{3}$.
    If $w_1$ is not in the fuller bin, then the result follows by Corollary~\ref{approximationCorollaryHelp2}.\newline
    Now assume \(w_1 < \frac{W}{3}\).
    In this case the RLS will move one object per step to the emptier bin.
    Each object has weight $< \frac{W}{3}$ and therefore one step cannot decrease the weight of the fuller bin from $> \frac{2W}{3}$ to $\le \frac{W}{3}$.
    If all objects except one where moved to one bin, the other bin would have a weight of at least \(W-w_1 > \frac{2W}{3}\).
    Therefore the RLS will find a solution with $b_F < \frac{2W}{3}$ before moving all elements from the first to the second bin.\newline
    The proof for the (1+1) EA is mostly the same.
    The main difference is the (1+1) EA being able to flip more than one bit in a single step.
    Such a step could make the emptier bin the fuller bin or increase the number of bits that must be shifted to the emptier bin.
    But with the results of Theorem~\ref{theo:OneMaxResult} the proof works exactly the same as for the RLS.
    The case \(w_1 \ge \frac{W}{3}\) does not change only the bin containing $w_1$ might change.
    Apart from that there is no difference for the (1+1) EA.
    The case $w_1 < \frac{W}{3}$ is also rather similar.
    The (1+1) EA will move elements from the fuller bin to the emptier bin until $b_F < \frac{2W}{3}$ holds. The (1+1) EA can make the emptier bin the fuller bin by moving multiple objects in one step, but this does not hinder it from reaching $b_F < \frac{2W}{3}$. After such a step it will continue moving elements until the condition holds.
\end{proof}

\begin{lemma}\label{approximationLemma}
    The RLS and the (1+1) EA reach an approximation ratio of at most $\frac{4}{3}$ in expected time $\mathcal{O}(n\log{}n)$ if $w_1 < W/2$
\end{lemma}
\begin{proof}    
    If \(w_1+w_2 > \frac{2W}{3}\) after time $\mathcal{O}(n)$ $w_1$ and $w_2$ are separated and will remain separated afterwards (3. Average case analysis, Theorem 1 in~\cite{diekert2005stacs}).
    From then on the following holds.
    If $w_1$ is in the emptier bin, then the result follows directly by Corollary~\ref{approximationCorollaryHelp2}.
    Otherwise all elements in the fuller bin except $w_1$ have a weight of at most $\frac{1}{3}$ and therefore the result follows by Lemma~\ref{movingObjectsLemma2} and Lemma~\ref{approximationLemmaHelp1}.
    If \(w_1+w_2 \le \frac{2W}{3}\) the result follows directly by Lemma~\ref{movingObjectsLemma2} and Lemma~\ref{approximationLemmaHelp1}.
\end{proof}

\begin{corollary}
    The RLS and the (1+1) EA reach an approximation ratio of at most $\frac{4}{3}$ in expected time $\mathcal{O}(n\log{}n)$
\end{corollary}
\begin{proof}
    This follows directly from Theorem~\ref{theo:OneMaxResult} and Lemma~\ref{approximationLemma}.
\end{proof}

\section{Binomial distributed input}
\begin{lemma}\label{lemma:BinomialSolvable}
    A binomial distributed input \textasciitilde$B(m,p)$ has a perfect partition ($b_F - b_E = 0$ for even $W$ and $b_F - b_E = 1$ for uneven $W$) with high probability if the input size $n$ is large enough.
\end{lemma}
\begin{proof}
    Sketch:
    \begin{itemize}
        \item The initial distribution is likely rather close to the optimum
        \item The difference between the bins is probably not more than 10 expected values
        \item the large values  
    \end{itemize}
    Consider a random separation of all values into two sets with equal size if $n$ is even or one set with one value more than the other if $n$ is odd. The sum X of one set is a sum of $\frac{n}{2}\cdot m$ independent Bernoulli trials with probability $p$. With Chernoff Bounds the following inequality follows: 
    \[\probP(X\ge(\frac{n}{2}+\sqrt{\frac{n}{2}})\cdot m \cdot p) = \probP(X\ge(1+2\sqrt{\frac{2}{n}})\cdot \frac{nmp}{2}) \le e^{-\frac{mnp}{2}\cdot2\sqrt{\frac{2}{n}}^2 /3} = e^{-\frac{2mp}{3}}\]
    For $mp\ge1.5$ the probability is less than $\frac{1}{e}$. Otherwise the input is rather trivial, since the numbers will be concentrated around 1.5 and most values will be below 10.\newline
    After moving $\mathcal{O}(\sqrt{\frac{n}{2}}/2)$ objects to the emptier set, the difference between the two sets is at most half the expected value $mp$ of a single value.
    \dots
\end{proof}


\begin{lemma}
    With high probability the RLS does not find an optimal solution for an input with distribution \textasciitilde$B(m,p)$ if n and m are large enough.
\end{lemma}
\begin{proof}
    Sketch:
    \begin{itemize}
        \item There exists an optimal solution with high probability due to last lemma
        \item probability for a value to be very low is almost 0 if m is huge
        \item The RLS only moves one element per step and will reach $b_F$-$b_E$ < $w_n$ without $b_F= opt$ being true
        \item -> RLS can't make another step and is stuck in a local optimum.
    \end{itemize}
    Due to Lemma~\ref{lemma:BinomialSolvable} the input has an optimal solution with high probability. The probability for small values \dots
\end{proof}